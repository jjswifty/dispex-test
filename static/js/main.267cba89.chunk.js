(this.webpackJsonpdispex=this.webpackJsonpdispex||[]).push([[0],{104:function(e,t,n){"use strict";n.r(t);var r=n(0),c=n.n(r),a=n(9),s=n.n(a),i=n(14),u=n(42),o=n(12),p=n(8),l=n.n(p),j=n(13),b=n(20),d=function e(t){Object(b.a)(this,e),this.instance=t.instance,this.instance.interceptors.request.use((function(e){return e.headers.Authorization="Bearer ".concat("eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9"),e}),(function(e){Promise.reject(e)}))},f=n(33),h=n(31),O="https://dispex.org/api/vtest",m=n(65),v=n.n(m),x=function e(t){Object(b.a)(this,e),this.instance=v.a.create({baseURL:t,headers:{"Content-Type":"application/json"}})},y=new(function(e){Object(f.a)(n,e);var t=Object(h.a)(n);function n(){var e;Object(b.a)(this,n);for(var r=arguments.length,c=new Array(r),a=0;a<r;a++)c[a]=arguments[a];return(e=t.call.apply(t,[this].concat(c))).getManagementCompanies=function(){var t=Object(j.a)(l.a.mark((function t(n){var r,c;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.instance.get("/Request/companies",{params:n});case 2:return r=t.sent,c=r.data,t.abrupt("return",c);case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.getStreets=function(){var t=Object(j.a)(l.a.mark((function t(n){var r,c;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.instance.get("/Request/streets",{params:n});case 2:return r=t.sent,c=r.data,t.abrupt("return",c);case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e}return n}(d))(new x(O)),g=new(function(e){Object(f.a)(n,e);var t=Object(h.a)(n);function n(){var e;Object(b.a)(this,n);for(var r=arguments.length,c=new Array(r),a=0;a<r;a++)c[a]=arguments[a];return(e=t.call.apply(t,[this].concat(c))).getClients=function(){var t=Object(j.a)(l.a.mark((function t(n){var r,c;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.instance.get("/HousingStock/client",{params:n});case 2:return r=t.sent,c=r.data,t.abrupt("return",c);case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.addClient=function(){var t=Object(j.a)(l.a.mark((function t(n){var r,c;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.instance.post("/HousingStock/client",{params:n});case 2:return r=t.sent,c=r.data,t.abrupt("return",c);case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.deleteClient=function(){var t=Object(j.a)(l.a.mark((function t(n){var r,c;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log(n,"service"),t.next=3,e.instance.delete("/HousingStock/bind_client/".concat(n));case 3:return r=t.sent,c=r.data,t.abrupt("return",c);case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e}return n}(d))(new x(O)),C=new(function(e){Object(f.a)(n,e);var t=Object(h.a)(n);function n(){var e;Object(b.a)(this,n);for(var r=arguments.length,c=new Array(r),a=0;a<r;a++)c[a]=arguments[a];return(e=t.call.apply(t,[this].concat(c))).getApartments=function(){var t=Object(j.a)(l.a.mark((function t(n){var r,c;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.instance.get("/HousingStock",{params:n});case 2:return r=t.sent,c=r.data,t.abrupt("return",c);case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e}return n}(d))(new x(O)),w="GET_COMPANIES",S="SET_APARTMENTS",E="SET_APARTMENTS_FETCHING",k="SET_STREETS_FETCHING",T="SET_IS_STREETS_FETCHED",N={streets:[],isApartmentsFetching:!1,isStreetsFetching:!1,apartments:[],isStreetsFetched:!1},I=function(e){return{type:k,boolean:e}},A=function(e){return{type:E,boolean:e}},F=function(e){return{type:w,streets:e}},_=function(e){return{type:S,apartments:e}},R=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:N,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case w:return Object(o.a)(Object(o.a)({},e),{},{streets:t.streets});case S:return Object(o.a)(Object(o.a)({},e),{},{apartments:t.apartments});case E:return Object(o.a)(Object(o.a)({},e),{},{isApartmentsFetching:t.boolean});case k:return Object(o.a)(Object(o.a)({},e),{},{isStreetsFetching:t.boolean});case T:return Object(o.a)(Object(o.a)({},e),{},{isStreetsFetched:t.boolean});default:return e}},H=n(132),M=n(135),P=n(137),D="SET_COMPANIES",L="SET_SELECTED_COMPANY",G="SET_SELECTED_COMPANY_NAME",J="SET_IS_COMPANY_SELECTED",q="TOGGLE_FETCHING",B={companies:[],selectedCompany:null,selectedCompanyName:"",isCompanySelected:!1,isFetching:!1},K=function(){return{type:q}},V=function(e){return{type:D,companies:e}},W=function(e){return{type:J,isCompanySelected:e}},Y=function(e,t){return function(n){var r;n((r=Number(e),{type:L,selectedCompany:r})),n({type:G,selectedCompanyName:t}),n(W(!0))}},z=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:B,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case D:return Object(o.a)(Object(o.a)({},e),{},{companies:t.companies});case L:return Object(o.a)(Object(o.a)({},e),{},{selectedCompany:t.selectedCompany});case G:return Object(o.a)(Object(o.a)({},e),{},{selectedCompanyName:t.selectedCompanyName});case J:return Object(o.a)(Object(o.a)({},e),{},{isCompanySelected:t.isCompanySelected});case q:return Object(o.a)(Object(o.a)({},e),{},{isFetching:!e.isFetching});default:return e}},U=n(19),X=n(3),Q=Object(H.a)({root:{listStyleType:"none"},card:{width:200,height:130,display:"flex",flexDirection:"column",textAlign:"center",border:"2px solid black",margin:2}}),Z=function(e){var t=Q(),n=Object(r.useState)(!1),c=Object(U.a)(n,2),a=c[0],s=c[1],i=function(){var t=Object(j.a)(l.a.mark((function t(){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,g.deleteClient(e.client.bindId);case 2:s(!0);case 3:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();return a?null:Object(X.jsx)("li",{className:t.root,children:Object(X.jsxs)("div",{className:t.card,children:[Object(X.jsx)("p",{children:"\u0416\u0438\u043b\u0435\u0446 ".concat(e.client.name,",")}),Object(X.jsx)("p",{children:"\u0442\u0435\u043b\u0435\u0444\u043e\u043d ".concat(e.client.phone)}),Object(X.jsx)("button",{onClick:i,children:"\u0423\u0434\u0430\u043b\u0438\u0442\u044c \u0436\u0438\u043b\u044c\u0446\u0430"})]})})},$=Object(H.a)({clients:{display:"flex",flexDirection:"row",flexWrap:"wrap"}}),ee=function(e){var t=$(),n=[],c=Object(r.useState)(""),a=Object(U.a)(c,2),s=a[0],i=a[1],u=Object(r.useState)(""),o=Object(U.a)(u,2),p=o[0],b=o[1],d=function(){var e=Object(j.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log(s,p),e.next=3,g.addClient({name:s,phone:p});case 3:t=e.sent,n.push({bindId:t.id,name:s,phone:p});case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(X.jsxs)("ul",{children:[Object(X.jsxs)("div",{className:t.clients,children:["\u0416\u0438\u043b\u044c\u0446\u044b",Object(X.jsx)("div",{children:e.apartment.clients.length>0&&e.apartment.clients.map((function(t,n){return Object(X.jsx)("div",{children:Object(X.jsx)(Z,{client:t,apartment:e.apartment})},t.bindId)}))})]}),Object(X.jsx)("div",{}),Object(X.jsx)("input",{value:s,onInput:function(e){return i(e.target.value)},placeholder:"\u0438\u043c\u044f"}),Object(X.jsx)("input",{onKeyPress:function(e){/[0-9]/.test(e.key)||e.preventDefault()},value:p,onInput:function(e){return b(String(e.target.value))},placeholder:"\u0442\u0435\u043b\u0435\u0444\u043e\u043d"}),Object(X.jsx)("button",{onClick:d,disabled:!s||!p,children:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0436\u0438\u043b\u044c\u0446\u0430"})]})},te=function(e){var t=Object(r.useState)(!1),n=Object(U.a)(t,2),c=n[0],a=n[1];return Object(X.jsxs)("ul",{children:[Object(X.jsxs)("button",{onClick:function(){a(!c)},children:["\u041a\u0432\u0430\u0440\u0442\u0438\u0440\u0430 ",e.index+1]}),c&&Object(X.jsx)(ee,{apartment:e.apartment})]})},ne=function(e){return e.apartments.map((function(e,t){return Object(X.jsx)(te,{index:t,apartment:e},e.addressId)}))},re=function(e){var t=Object(r.useState)(!1),n=Object(U.a)(t,2),c=n[0],a=n[1];return Object(X.jsxs)("li",{children:[Object(X.jsxs)("button",{onClick:function(){a(!c)},children:["\u0414\u043e\u043c ",e.houseNumber]}),c&&e.streetHouses.map((function(e,t){return Object(X.jsx)(ne,{apartments:Object.values(e)},t)}))]})},ce=function(e){return e.streetHousesKeys.map((function(t){return Object(X.jsx)(re,{houseNumber:t,streetHouses:e.streetHouses},t)}))},ae=Object(H.a)({button:{margin:3}}),se=function(e){var t=ae(),n=e.street,c=Object.keys(n.houses),a=Object(r.useState)(!1),s=Object(U.a)(a,2),i=s[0],u=s[1];return 0!==c.length&&Object(X.jsxs)("div",{children:[Object(X.jsx)(M.a,{variant:"outlined",className:t.button,onClick:function(){u(!i)},children:n.name}),Object(X.jsx)("div",{children:i&&c.map((function(e,t){return Object(X.jsx)("div",{children:Object(X.jsx)("ul",{children:Object(X.jsx)(ce,{streetHousesKeys:c,streetHouses:Object.values(n.houses)})})},e)}))})]},n.id)},ie=function(e){var t=e.streets;return t&&t.map((function(e){return Object(X.jsx)(se,{street:e},e.id)}))},ue=Object(H.a)({root:{height:"100%",maxWidth:"100%",paddingLeft:10}}),oe=function(e){var t=Object(i.b)(),n=ue(),c=e.selectedCompany,a=Object(i.c)((function(e){return e.apartmentsReducer.isStreetsFetching})),s=Object(i.c)((function(e){return e.apartmentsReducer.isStreetsFetched})),p=Object(i.c)((function(e){return e.apartmentsReducer.isApartmentsFetching})),b=Object(i.c)((function(e){return e.apartmentsReducer.apartments})),d=Object(i.c)((function(e){return e.apartmentsReducer.streets})),f=Object(i.c)((function(e){return e.companiesReducer.selectedCompanyName}));Object(r.useEffect)((function(){var e;s||t(function(){var e=Object(j.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t(I(!0)),e.prev=1,e.next=4,y.getStreets();case 4:n=e.sent,t(F(n)),t({type:T,boolean:!0}),e.next=12;break;case 9:throw e.prev=9,e.t0=e.catch(1),new Error(e.t0);case 12:return e.prev=12,t(I(!1)),e.finish(12);case 15:case"end":return e.stop()}}),e,null,[[1,9,12,15]])})));return function(t){return e.apply(this,arguments)}}()),t((e=c,function(){var t=Object(j.a)(l.a.mark((function t(n){var r;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n(A(!0)),t.prev=1,t.next=4,C.getApartments({companyId:e});case 4:r=t.sent,n(_(r)),t.next=11;break;case 8:throw t.prev=8,t.t0=t.catch(1),new Error(t.t0);case 11:return t.prev=11,n(A(!1)),t.finish(11);case 14:case"end":return t.stop()}}),t,null,[[1,8,11,14]])})));return function(e){return t.apply(this,arguments)}}()))}),[]),d&&d.forEach((function(e){var t=b.filter((function(t){return t.streetId===e.id})),n={};t.forEach((function(e){n[e.houseId]=Object(o.a)(Object(o.a)({},n[e.houseId]),{},Object(u.a)({},e.addressId,e))})),e.houses=n}));var h=p||a;return Object(X.jsxs)("div",{className:n.root,children:[Object(X.jsx)(M.a,{variant:"contained",color:"primary",onClick:function(){return t(W(!1))},disabled:h,children:"\u041d\u0430\u0437\u0430\u0434 \u043a \u0432\u044b\u0431\u043e\u0440\u0443"}),Object(X.jsxs)(P.a,{variant:"subtitle1",children:["\u0423\u043f\u0440\u0430\u0432\u043b\u044f\u044e\u0449\u0430\u044f \u043a\u043e\u043c\u043f\u0430\u043d\u0438\u044f ",f]}),Object(X.jsxs)(P.a,{variant:"subtitle2",children:[f," \u0438\u043c\u0435\u0435\u0442 \u0434\u043e\u043c\u0430 \u043d\u0430 \u0434\u0430\u043d\u043d\u044b\u0445 \u0443\u043b\u0438\u0446\u0430\u0445: (\u0441\u0434\u0435\u043b\u0430\u043d\u043e \u0447\u0442\u043e-\u0431\u044b \u043d\u0435 \u043f\u043e\u043a\u0430\u0437\u044b\u0432\u0430\u043b\u043e \u0432\u0441\u0435 \u0443\u043b\u0438\u0446\u044b, \u043c\u043d\u043e\u0433\u043e \u043f\u0443\u0441\u0442\u044b\u0445)"]}),h?Object(X.jsx)(P.a,{variant:"subtitle1",children:"\u0417\u0410\u0413\u0420\u0423\u0417\u041a\u0410..."}):Object(X.jsx)(ie,{streets:d})]})},pe=n(138),le=n(142),je=n(141),be=n(143),de=Object(H.a)({root:{margin:0,padding:0,width:"100%",minHeight:"100vh",display:"flex",justifyContent:"center",alignItems:"center"},formControl:{minWidth:250}}),fe=function(e){var t=Object(i.b)(),n=de(),c=Object(i.c)((function(e){return e.companiesReducer.companies}));Object(r.useEffect)((function(){t(function(){var e=Object(j.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t(K()),e.prev=1,e.next=4,y.getManagementCompanies();case 4:n=e.sent,t(V(n)),e.next=11;break;case 8:throw e.prev=8,e.t0=e.catch(1),new Error(e.t0);case 11:return e.prev=11,t(K()),e.finish(11);case 14:case"end":return e.stop()}}),e,null,[[1,8,11,14]])})));return function(t){return e.apply(this,arguments)}}())}),[]);return Object(X.jsx)("div",{className:n.root,children:Object(X.jsxs)(pe.a,{className:n.formControl,children:[Object(X.jsx)(le.a,{children:"\u0423\u043f\u0440\u0430\u0432\u043b\u044f\u044e\u0449\u0430\u044f \u043a\u043e\u043c\u043f\u0430\u043d\u0438\u044f"}),Object(X.jsx)(je.a,{onChange:function(e){return function(e){var n=e.id,r=e.name;t(Y(n,r))}(e.target.value)},defaultValue:"",children:c&&c.map((function(e){return Object(X.jsx)(be.a,{value:{id:e.id,name:e.name},children:e.name},e.id)}))})]})})},he=n(71),Oe=n(139),me=n(140),ve=Object(he.a)({palette:{type:"dark"},typography:{allVariants:{color:"white"}}}),xe=Object(H.a)({root:{margin:0,padding:0,width:"100%",minHeight:"100vh"}}),ye=function(){var e=xe(),t=Object(i.c)((function(e){return e.companiesReducer.isCompanySelected})),n=Object(i.c)((function(e){return e.companiesReducer.selectedCompany}));return Object(X.jsxs)(Oe.a,{theme:ve,children:[Object(X.jsx)(me.a,{}),Object(X.jsx)("div",{className:e.root,children:t?Object(X.jsx)(oe,{selectedCompany:n}):Object(X.jsx)(fe,{})})]})},ge=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,144)).then((function(t){var n=t.getCLS,r=t.getFID,c=t.getFCP,a=t.getLCP,s=t.getTTFB;n(e),r(e),c(e),a(e),s(e)}))},Ce=n(49),we=n(70),Se=Object(Ce.b)({apartmentsReducer:R,companiesReducer:z}),Ee=Object(Ce.c)(Se,Object(Ce.a)(we.a));window.store=Ee;var ke=Ee;s.a.render(Object(X.jsx)(c.a.StrictMode,{children:Object(X.jsx)(i.a,{store:ke,children:Object(X.jsx)(ye,{})})}),document.getElementById("root")),ge()}},[[104,1,2]]]);
//# sourceMappingURL=main.267cba89.chunk.js.map